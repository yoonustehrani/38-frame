import{r as m,a as o,j as t,F as f}from"./client-abbe1494.js";import{u as w}from"./formContext-6cf63da9.js";import{c as b,d as C}from"./api-952bf031.js";import{I as v}from"./Input-4acd9be4.js";import{T as _}from"./TextArea-3a09a8ba.js";import{t as R}from"./numbers-13582722.js";import"./hoist-non-react-statics.cjs-3f8ebaa8.js";import"./Request-86ea05f5.js";import"./index.esm-14f15176.js";import"./FormSection-0da77780.js";const I=({selectGroup:e,selectedGroup:r})=>{const[s,l]=m.useState([]);return m.useEffect(()=>{const[c,i]=b();return c.then(d=>{d.hasErrors()||l(d.getContent())}),()=>i()},[]),o("select",{className:"w-fit form-input px-2 py-1",value:r??"",onChange:c=>e(Number(c.target.value)),children:[t("option",{value:"",children:"دسته بندی خدمات را انتخاب کنید"}),s.map(c=>t("option",{value:c.id,children:c.label},c.id))]})},V=({selectService:e,selectedGroup:r,selectedService:s})=>{const[l,c]=m.useState([]);return m.useEffect(()=>{const[i,d]=C(r);return i.then(u=>{u.hasErrors()||c(u.getContent())}),()=>d()},[r]),o("select",{className:"w-fit form-input px-2 py-1",value:s??"",onChange:i=>{var d;e(Number(i.target.value),((d=l.filter(u=>u.id===Number(i.target.value))[0])==null?void 0:d.label)??"")},children:[t("option",{value:"",children:"انتخاب کنید"}),l.map(i=>t("option",{value:i.id,children:i.label},i.id))]})},A=(e,r)=>{switch(r.type){case"SET_SERVICE":return{...e,title:r.payload.title,service_id:r.payload.id};case"SET_DESCRIPTION":return{...e,description:r.payload};case"SET_PRICE":return{...e,price:r.payload};case"SET_PRICE_NOTE":return{...e,price_note:r.payload};case"CLEAR":return{service_id:e==null?void 0:e.service_id,title:e==null?void 0:e.title};case"CLEAR_ALL":return{};default:return e}},T=({appendService:e})=>{const[r,s]=m.useState(),[l,c]=m.useReducer(A,{});let{service_id:i,description:d,price:u,price_note:n}=l;m.useEffect(()=>{i&&c({type:"CLEAR"})},[i,r]);function y(p,S){c({type:"SET_SERVICE",payload:{id:p,title:S}})}function x(p){c({type:"SET_PRICE",payload:p})}function E(p){c({type:"SET_PRICE_NOTE",payload:p})}function N(p){c({type:"SET_DESCRIPTION",payload:p})}return o("div",{className:"col-span-full flex flex-wrap gap-3 items-center",children:[t(I,{selectGroup:s,selectedGroup:r}),r&&t(V,{selectService:y,selectedService:i,selectedGroup:r}),i&&o("section",{className:"w-full py-3 grid grid-cols-1 md:grid-cols-2 gap-4",children:[t(v,{value:u,onChange:p=>x(Number(p.target.value)),name:"unimportant[price]",type:"number",min:1e3,step:1e3,label:"قیمت",id:"service-price",className:"px-3 py-2",children:u&&o("p",{className:"py-4 px-3",children:[new Intl.NumberFormat("fa-IR").format(u)," تومان"]})},`${i}-price`),t(v,{value:n,onChange:p=>E(p.target.value),name:"unimportant[price_note]",label:"توضیحات قیمت",id:"service-price-note",className:"px-3 py-2"},`${i}-price-note`),t(_,{required:!0,label:"توضیحات",id:"service-description",value:d,onChange:p=>N(p.target.value),name:"unimportant[description]",className:"px-3 py-2"},`${i}-description`)]}),d&&d.length>3&&t("div",{className:"w-full py-2 flex items-center justify-center",children:o("button",{type:"button",onClick:()=>{e(l),c({type:"CLEAR_ALL"})},className:"flex flex-row-reverse items-center gap-2 font-bold duration-300 hover:fill-emerald-900 hover:text-emerald-900",children:[t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"26",height:"26",children:t("path",{d:"M17,12c0,.553-.448,1-1,1h-3v3c0,.553-.448,1-1,1s-1-.447-1-1v-3h-3c-.552,0-1-.447-1-1s.448-1,1-1h3v-3c0-.553,.448-1,1-1s1,.447,1,1v3h3c.552,0,1,.447,1,1Zm7-7v14c0,2.757-2.243,5-5,5H5c-2.757,0-5-2.243-5-5V5C0,2.243,2.243,0,5,0h14c2.757,0,5,2.243,5,5Zm-2,0c0-1.654-1.346-3-3-3H5c-1.654,0-3,1.346-3,3v14c0,1.654,1.346,3,3,3h14c1.654,0,3-1.346,3-3V5Z"})}),"افزودن"]})})]})};let h;const D=new Uint8Array(16);function H(){if(!h&&(h=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!h))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return h(D)}const a=[];for(let e=0;e<256;++e)a.push((e+256).toString(16).slice(1));function U(e,r=0){return a[e[r+0]]+a[e[r+1]]+a[e[r+2]]+a[e[r+3]]+"-"+a[e[r+4]]+a[e[r+5]]+"-"+a[e[r+6]]+a[e[r+7]]+"-"+a[e[r+8]]+a[e[r+9]]+"-"+a[e[r+10]]+a[e[r+11]]+a[e[r+12]]+a[e[r+13]]+a[e[r+14]]+a[e[r+15]]}const L=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),g={randomUUID:L};function M(e,r,s){if(g.randomUUID&&!r&&!e)return g.randomUUID();e=e||{};const l=e.random||(e.rng||H)();if(l[6]=l[6]&15|64,l[8]=l[8]&63|128,r){s=s||0;for(let c=0;c<16;++c)r[s+c]=l[c];return r}return U(l)}const P=(e,r)=>{switch(r.type){case"ADD_SERVICE":return[...e,{...r.payload,id:M()}];case"REMOVE_SERVICE":return e.filter(s=>s.id!==r.payload)}return e},J=()=>{const[e,r,s]=w({name:"services"}),l=m.useMemo(()=>e.value,[]),[c,i]=m.useReducer(P,l);m.useEffect(()=>{s.setValue(c.map(n=>({service_id:n.service_id,description:n.description,price:n.price,price_note:n.price_note})))},[c.length]);function d(n){i({type:"REMOVE_SERVICE",payload:n})}function u(n){i({type:"ADD_SERVICE",payload:n})}return o(f,{children:[t(T,{appendService:u}),t("div",{className:"col-span-full relative",children:o("table",{className:"w-full text-sm text-cetner text-gray-500 dark:text-gray-400",children:[t("thead",{className:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400",children:o("tr",{children:[t("th",{className:"py-2",children:"#"}),t("th",{className:"py-2",children:"عنوان"}),t("th",{className:"py-2",children:"نرخ خدمات"}),t("th",{className:"py-2",children:"توضیحات"}),t("th",{className:"py-2",children:"عملیات"})]})}),t("tbody",{children:c.map((n,y)=>o("tr",{className:"text-center bg-white border-b dark:bg-gray-800 dark:border-gray-700",children:[t("th",{scope:"row",className:"px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white",children:y+1}),t("td",{className:"px-6 py-4",children:n.title}),o("td",{className:"px-6 py-4",children:[n.price?`${R(n.price)} تومان`:"",t("br",{}),n.price_note]}),t("td",{className:"px-6 py-4",children:n.description}),t("td",{className:"px-6 py-4 flex justify-center items-center",children:t("button",{onClick:()=>d(n.id),type:"button",className:"bg-red-100 fill-red-900 w-7 h-7 rounded-md flex justify-center items-center",children:o("svg",{className:"fill-inherit",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"18",height:"18",children:[t("path",{d:"M21,4H17.9A5.009,5.009,0,0,0,13,0H11A5.009,5.009,0,0,0,6.1,4H3A1,1,0,0,0,3,6H4V19a5.006,5.006,0,0,0,5,5h6a5.006,5.006,0,0,0,5-5V6h1a1,1,0,0,0,0-2ZM11,2h2a3.006,3.006,0,0,1,2.829,2H8.171A3.006,3.006,0,0,1,11,2Zm7,17a3,3,0,0,1-3,3H9a3,3,0,0,1-3-3V6H18Z"}),t("path",{d:"M10,18a1,1,0,0,0,1-1V11a1,1,0,0,0-2,0v6A1,1,0,0,0,10,18Z"}),t("path",{d:"M14,18a1,1,0,0,0,1-1V11a1,1,0,0,0-2,0v6A1,1,0,0,0,14,18Z"})]})})})]},n.service_id))})]})})]})};export{J as default};
